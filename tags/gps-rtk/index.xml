<rss version="2.0" xmlns:atom="http://www.w3.org/2005/Atom"><channel><title>Open Mower â€“ gps-rtk</title><link>/tags/gps-rtk/</link><description>Recent content in gps-rtk on Open Mower</description><generator>Hugo -- gohugo.io</generator><atom:link href="/tags/gps-rtk/index.xml" rel="self" type="application/rss+xml"/><item><title>Docs: Prepare the GPS</title><link>/docs/robot-assembly/prepare-the-parts/prepare-the-gps/</link><pubDate>Mon, 01 Jan 0001 00:00:00 +0000</pubDate><guid>/docs/robot-assembly/prepare-the-parts/prepare-the-gps/</guid><description>
&lt;div class="alert alert-info" role="alert">
&lt;h4 class="alert-heading">Info&lt;/h4>
There is a tutorial video available for this step of the process! &lt;br/>
Check my YouTube video here: &lt;a href="https://youtu.be/_bImqD-pQSA?t=981">&lt;i class="fa fa-brands fa-youtube">&lt;/i> Video&lt;/a>
(time 16:21 - 17:15)
&lt;/div>
&lt;h2 id="configure-the-gps-board">Configure the GPS board&lt;/h2>
&lt;p>This assumes that you are using the Ardusimple F9P GPS board. Support for other GPS receivers is a work in progress.&lt;/p>
&lt;h3 id="prerequisites">Prerequisites&lt;/h3>
&lt;ul>
&lt;li>&lt;strong>A Micro USB Cable&lt;/strong>&lt;/li>
&lt;li>&lt;strong>A Windows PC&lt;/strong>&lt;/li>
&lt;li>&lt;strong>Latest version of the u-center software:&lt;/strong>&lt;br/>
ðŸ”—Â &lt;a href="https://www.u-blox.com/en/product/u-center">https://www.u-blox.com/en/product/u-center&lt;/a>&lt;br/>
Don&amp;rsquo;t get u-center V2, you will need u-center v1 for the F9P.&lt;/li>
&lt;li>&lt;strong>The GPS configuration file&lt;/strong>&lt;br/>
ðŸ”—Â &lt;a href="https://raw.githubusercontent.com/ClemensElflein/OpenMower/main/configs/GPSConfig/Robot.txt" target="_blank">Robot.txt&lt;/a>&lt;br/>
This will open in the browser. Use CTRL+S to download the file.&lt;/li>
&lt;/ul>
&lt;h3 id="step-0-update-firmware">Step 0: Update Firmware&lt;/h3>
&lt;p>Update the firmware of your Ardusimple board to version &lt;code>ZED-F9P HPG 1.32&lt;/code>. There&amp;rsquo;s a guide on the &lt;a href="https://www.ardusimple.com/zed-f9p-firmware-update-with-simplertk2b/">Ardusimple Website&lt;/a>.&lt;/p>
&lt;h3 id="step-1-open-u-center-and-connect-to-your-gps">Step 1: Open u-center and connect to your GPS&lt;/h3>
&lt;p>After installing u-center, connect your Ardusimple board using the &amp;ldquo;Power+GPS&amp;rdquo; USB socket to your Windows computer. You should see the blue LEDs of the board come on and Windows should recognize the device as a COM port.
With the module connected to your PC, open the u-center software.&lt;/p>
&lt;p>In u-center, first connect to your board by selecting the appropriate COM port in the &lt;code>Receiver &amp;gt; Connection&lt;/code> menu.&lt;/p>
&lt;h3 id="step-2-transfer-the-configuration-to-the-gps">Step 2: Transfer the configuration to the GPS&lt;/h3>
&lt;p>&lt;img src="transfer-gps-settings.jpg" alt="Transfer Settings to u-center">&lt;/p>
&lt;p>After successfully connecting to the board, you can transfer
the previously downloaded configuration file &lt;code>Robot.txt&lt;/code> by opening the window &lt;code>Tools &amp;gt; Receiver Configuration ...&lt;/code>. In this window you open the &lt;code>Robot.txt&lt;/code> using the &lt;code>...&lt;/code> button and then transfer the configuration to the GPS by clicking the &lt;code>Transfer File -&amp;gt; GNSS&lt;/code> button.&lt;/p>
&lt;h3 id="step-3-save-configuration-to-flash">Step 3: Save configuration to Flash&lt;/h3>
&lt;p>&lt;img src="save-settings-to-flash.jpg" alt="Save Settings to Flash">&lt;/p>
&lt;p>In order to keep the GPS configured even after powering it down, you need to save the current configuration to Flash memory. In order to do this, select &lt;code>View &amp;gt; Configuration View&lt;/code>. In the new window you need to select &lt;code>CFG (Configuration)&lt;/code> in the list on the left side and then enable &lt;code>Save current configuration&lt;/code>. Make sure that &lt;code>0 - BBR&lt;/code> and &lt;code>1 - FLASH&lt;/code> are both selected on the right side of the window. Once that&amp;rsquo;s done, click the &lt;code>Send&lt;/code> button in the lower toolbar of the window.&lt;/p>
&lt;h3 id="step-4-done-">Step 4: Done ðŸŽ‰&lt;/h3>
&lt;p>Your GPS is now configured for use with the Open Mower software. You can disconnect it from your Windows PC.&lt;/p></description></item><item><title>Docs: Troubleshooting GPS-RTK</title><link>/docs/troubleshooting/gps-rtk/</link><pubDate>Mon, 01 Jan 0001 00:00:00 +0000</pubDate><guid>/docs/troubleshooting/gps-rtk/</guid><description>
&lt;p>We assume that you at least followed &lt;a href="/docs/robot-assembly/prepare-the-parts/prepare-the-gps/">documentation of GPS setup&lt;/a>. If mower is already assembled - open the top cover.&lt;/p>
&lt;p>Get your Windows PC and connect to GPS module directly with microUSB cable (as if you were uploading the configuration).&lt;/p>
&lt;p>Make sure that &lt;code>Protocol of received messages&lt;/code> in bottom status bar right shows &lt;code>UBX&lt;/code>, not &lt;code>NMEA&lt;/code>. If not - upload configuration again. Then disconnect/connect power of GPS and make sure it stayed &lt;code>UBX&lt;/code>.&lt;/p>
&lt;p>Connect the antenna to the board and go outside to check if general GPS is working. If the mower is already assembled and an antenna is plugged in - just take it outside with the mower.
Even indoors next to the windows with antenna connected, you should see satellites and other info start appearing in u-center. In few minutes &lt;code>GPS Fix&lt;/code> led will start blinking on GPS board.&lt;/p>
&lt;p>Deviation map (&lt;code>View-&amp;gt;Deviation Map, F12&lt;/code>) should stay in a ~1m, that what you expect from average GPS. If you got some existing garbage there already, clean it via &lt;code>File-&amp;gt;Database clean&lt;/code>.&lt;/p>
&lt;p>Now let&amp;rsquo;s connect NTRIP. We assume that you either found a suitable &lt;a href="https://discord.com/channels/958476543846412329/980099128879108137/980100319700742145">NTRIP node somewhere nearby&lt;/a> (&amp;lt;30km) or running your own &lt;a href="/docs/rtk-base-setup/">base station&lt;/a>.&lt;/p>
&lt;p>Go to &lt;code>Receiver-&amp;gt;NTRIP Client...&lt;/code> and configure your NTRIP settings. This will be the same settings that you will use in &lt;a href="/docs/robot-assembly/prepare-the-parts/prepare-sd-card/#openmowermower_configtxt-on-linux-bootopenmowermower_configtxt">configuration file later&lt;/a>.
&lt;figure class="card rounded p-2 td-post-card mb-4 mt-4" style="max-width: 510px">
&lt;img class="card-img-top" src="/docs/troubleshooting/gps-rtk/ntrip-client_hu093974d0b20218b173b54badb71bcd6b_31055_500x0_resize_catmullrom_3.png" width="500" height="460">
&lt;/figure>
&lt;/p>
&lt;p>NTRIP client should display green connection in the status bar. Deviation map (&lt;code>View-&amp;gt;Deviation Map, F12&lt;/code>) should stay dead center. &lt;code>No RTK&lt;/code> led will start blinking or go away completely.
&lt;figure class="card rounded p-2 td-post-card mb-4 mt-4" style="max-width: 810px">
&lt;img class="card-img-top" src="/docs/troubleshooting/gps-rtk/gps-fix-and-deviation_hu6cbd1643a4df8dcd346344c082d9a5e1_47047_800x0_resize_catmullrom_3.png" width="800" height="484">
&lt;/figure>
&lt;/p>
&lt;h2 id="test-gps-on-mainboard">Test GPS on Mainboard&lt;/h2>
&lt;p>We have checked that GPS works alone, let&amp;rsquo;s see if it would together with mainboard. Plug GPS into mainboard. Everything should light up and start flashing. Wait until you are GREEN or RED/GREEN.&lt;/p>
&lt;div class="alert alert-info" role="alert">
&lt;h4 class="alert-heading">ðŸ”‹ Powering the mainboard&lt;/h4>
If you don&amp;rsquo;t have dock station assembled and want to save the power in the main mower battery, you can power it from the Pico Dev board MicroUSB port, right below the GPS board. Use a 1A+ power bank, because computer USB port&amp;rsquo;s 500mA might be not enough.
&lt;/div>
&lt;p>Then SSH into OpenMower console. In the home directory there&amp;rsquo;s do &lt;code>./start_ros_bash.sh&lt;/code> which should take you to a bash inside the docker, then you can do &lt;code>rostopic list&lt;/code> to list all topics and &lt;code>rostopic echo -c -w 5 /xbot_driver_gps/xb_pose&lt;/code> to look at the GPS data. There&amp;rsquo;s a position and some accuracy number in meters.&lt;/p>
&lt;div class="highlight">&lt;pre tabindex="0" style="background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4">&lt;code class="language-yaml" data-lang="yaml">&lt;span style="color:#204a87;font-weight:bold">header&lt;/span>&lt;span style="color:#000;font-weight:bold">:&lt;/span>&lt;span style="color:#f8f8f8;text-decoration:underline">
&lt;/span>&lt;span style="color:#f8f8f8;text-decoration:underline"> &lt;/span>&lt;span style="color:#204a87;font-weight:bold">seq&lt;/span>&lt;span style="color:#000;font-weight:bold">:&lt;/span>&lt;span style="color:#f8f8f8;text-decoration:underline"> &lt;/span>&lt;span style="color:#0000cf;font-weight:bold">318&lt;/span>&lt;span style="color:#f8f8f8;text-decoration:underline">
&lt;/span>&lt;span style="color:#f8f8f8;text-decoration:underline"> &lt;/span>&lt;span style="color:#204a87;font-weight:bold">frame_id&lt;/span>&lt;span style="color:#000;font-weight:bold">:&lt;/span>&lt;span style="color:#f8f8f8;text-decoration:underline"> &lt;/span>&lt;span style="color:#4e9a06">&amp;#34;gps&amp;#34;&lt;/span>&lt;span style="color:#f8f8f8;text-decoration:underline">
&lt;/span>&lt;span style="color:#f8f8f8;text-decoration:underline">&lt;/span>&lt;span style="color:#204a87;font-weight:bold">orientation_valid&lt;/span>&lt;span style="color:#000;font-weight:bold">:&lt;/span>&lt;span style="color:#f8f8f8;text-decoration:underline"> &lt;/span>&lt;span style="color:#0000cf;font-weight:bold">0&lt;/span>&lt;span style="color:#f8f8f8;text-decoration:underline">
&lt;/span>&lt;span style="color:#f8f8f8;text-decoration:underline">&lt;/span>&lt;span style="color:#204a87;font-weight:bold">motion_vector_valid&lt;/span>&lt;span style="color:#000;font-weight:bold">:&lt;/span>&lt;span style="color:#f8f8f8;text-decoration:underline"> &lt;/span>&lt;span style="color:#0000cf;font-weight:bold">1&lt;/span>&lt;span style="color:#f8f8f8;text-decoration:underline">
&lt;/span>&lt;span style="color:#f8f8f8;text-decoration:underline">&lt;/span>&lt;span style="color:#204a87;font-weight:bold">position_accuracy&lt;/span>&lt;span style="color:#000;font-weight:bold">:&lt;/span>&lt;span style="color:#f8f8f8;text-decoration:underline"> &lt;/span>&lt;span style="color:#0000cf;font-weight:bold">0.021&lt;/span>&lt;span style="color:#f8f8f8;text-decoration:underline"> &lt;/span>&lt;span style="color:#8f5902;font-style:italic"># this is good&lt;/span>&lt;span style="color:#f8f8f8;text-decoration:underline">
&lt;/span>&lt;span style="color:#f8f8f8;text-decoration:underline">&lt;/span>&lt;span style="color:#204a87;font-weight:bold">orientation_accuracy&lt;/span>&lt;span style="color:#000;font-weight:bold">:&lt;/span>&lt;span style="color:#f8f8f8;text-decoration:underline"> &lt;/span>&lt;span style="color:#0000cf;font-weight:bold">3.141&lt;/span>&lt;span style="color:#f8f8f8;text-decoration:underline">
&lt;/span>&lt;/code>&lt;/pre>&lt;/div></description></item></channel></rss>